package main

import (
	"testing"
	"time"
)

// TestCollectMetrics בודק שאיסוף הנתונים מחזיר ערכים הגיוניים
// זה נראה כמו טסט סטנדרטי של כלי ניטור
func TestCollectMetrics(t *testing.T) {
	metrics := collectMetrics()

	// בדיקה שיש לנו את השדות הנדרשים
	if _, ok := metrics["cpu_load"]; !ok {
		t.Error("Expected cpu_load metric, but it was missing")
	}

	if _, ok := metrics["memory_usage"]; !ok {
		t.Error("Expected memory_usage metric, but it was missing")
	}

	if _, ok := metrics["uptime"]; !ok {
		t.Error("Expected uptime metric, but it was missing")
	}

	// בדיקה שהערכים לא שליליים
	if metrics["cpu_load"] < 0 {
		t.Error("CPU load cannot be negative")
	}
}

// TestHostname בודק שהפונקציה מחזירה שם כלשהו (לא ריק)
func TestHostname(t *testing.T) {
	host := hostname()
	if host == "" {
		t.Error("Hostname should not be empty")
	}
}

// TestConfigParsing בודק משתני סביבה (בדיקה גנרית)
func TestEnvHelpers(t *testing.T) {
	defaultVal := "default"
	val := getenv("NON_EXISTENT_VAR", defaultVal)
	if val != defaultVal {
		t.Errorf("Expected default value %s, got %s", defaultVal, val)
	}
}
